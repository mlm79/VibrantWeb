<html>

<head>
    <script type="text/javascript" src='js/jquery-1.6.4.min.js'></script>
    <script type="text/javascript" src='js/jstorage.js'></script>
    <script type="text/javascript" src='js/utils.js'></script>
    <link rel="stylesheet" href="css/popup.css" />
  </head>

<style>

</style>

<body>
	<div id="main">
		<div id="title"></div>
		<div id="homepage"></div>
		<div id="onOff">
			<div class='button' id="sessionOff">OFF</div>
			<div class='button' id="sessionOn">ON</div>
		</div>
		<div id="clearHistory">clear history</div>
	</div>	
</body>

<script type="text/javascript">
	var btns = {
		sessionOn: {
			val:true
		},
		sessionOff: {
			val:false
		}
	}

	chrome.extension.sendRequest({method:"get",dataLabel:"sessionState"}, function(response) {
		console.log(response.method);
		console.log(response.data["sessionOn"]);
		if (response.data["sessionOn"]) {
			$("#sessionOn").addClass("selected");
			$("#sessionOff").addClass("de-selected");
		} else {
			$("#sessionOff").addClass("selected");
			$("#sessionOn").addClass("de-selected");
		}
		
	});



	$(".button").click(function(){
		$(this).removeClass("de-selected").addClass("selected");
		$(this).siblings().removeClass("selected").addClass("de-selected");
		var val = btns[$(this).attr('id')].val;
    	chrome.extension.sendRequest({method:"set",dataLabel:"sessionState",data:{"sessionOn":val}}, function(response) {
			console.log(response.method);
			console.log(response.data);
		});
	});
	
	$("#clearHistory").click(function() {
		chrome.extension.sendRequest({method:"delete",dataLabel:"browsingData"}, function(response) {
			console.log(response.method);
			console.log(response.size);
		});	
	})
	
	$("#homepage").click(function(){
		chrome.tabs.create({url:chrome.extension.getURL('landingpage.html')});
		window.close();
	})

</script>
</html>